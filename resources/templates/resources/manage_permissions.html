{% extends 'base.html' %}
{% block title %}Manage Permissions - {{ group.name }}{% endblock %}
{% block content %}
<style>
    .permissions-container {
        max-width: 700px;
        margin: 0 auto;
    }
    
    .permissions-card {
        background: white;
        border-radius: 16px;
        padding: 2.5rem;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    }
    
    .permissions-card h1 {
        color: var(--text-dark);
        margin-bottom: 0.5rem;
    }
    
    .subtitle {
        color: var(--text-gray);
        margin-bottom: 2rem;
    }
    
    .info-box {
        background: var(--light-blue);
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 2rem;
    }
    
    .info-box h3 {
        color: var(--primary-blue);
        margin-bottom: 0.5rem;
        font-size: 1rem;
    }
    
    .info-box ul {
        margin: 0;
        padding-left: 1.5rem;
    }
    
    .info-box li {
        color: var(--text-gray);
        margin: 0.25rem 0;
    }
    
    .form-group {
        margin-bottom: 2rem;
    }
    
    .form-group label {
        display: block;
        color: var(--text-dark);
        font-weight: 500;
        margin-bottom: 1rem;
    }
    
    .checkbox-list {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }
    
    .checkbox-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem;
        border-radius: 8px;
        transition: background 0.2s;
    }
    
    .checkbox-item:hover {
        background: var(--light-blue);
    }
    
    .checkbox-item input[type="checkbox"] {
        width: 18px;
        height: 18px;
        cursor: pointer;
    }
    
    .checkbox-item label {
        margin: 0;
        cursor: pointer;
        font-weight: 400;
    }
    
    .no-members {
        color: var(--text-gray);
        font-style: italic;
        padding: 1rem;
        background: #f8f9fa;
        border-radius: 8px;
    }
    
    .form-actions {
        display: flex;
        gap: 1rem;
        margin-top: 2rem;
    }
    
    .back-link {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-gray);
        text-decoration: none;
        margin-bottom: 1rem;
        transition: color 0.2s;
    }
    
    .back-link:hover {
        color: var(--primary-blue);
    }
</style>

<a href="{% url 'group_detail' group.id %}" class="back-link">
    ‚Üê Back to Group
</a>

<div class="permissions-container">
    <div class="permissions-card">
        <h1><svg class="icon" style="vertical-align: middle;"><use href="#icon-users"></use></svg> Manage Permissions</h1>
        <p class="subtitle">{{ group.name }}</p>
        
        <div class="info-box">
            <h3>Role Permissions:</h3>
            <ul>
                <li><strong>Admins:</strong> Can manage members, remove members, create invites, and edit group</li>
                <li><strong>Editors:</strong> Can only edit group information</li>
                <li><strong>Creator:</strong> Has all permissions automatically (cannot be changed)</li>
            </ul>
        </div>
        
        <form method="post">
            {% csrf_token %}
            
            <div class="form-group">
                <label>{{ form.admins.label }}</label>
                {% if form.admins.field.queryset %}
                    <div class="checkbox-list">
                        {% for checkbox in form.admins %}
                            <div class="checkbox-item">
                                {{ checkbox.tag }}
                                {{ checkbox.choice_label }}
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="no-members">No other members to assign as admins</div>
                {% endif %}
                {% if form.admins.errors %}
                    <div class="error-message">{{ form.admins.errors }}</div>
                {% endif %}
            </div>
            
            <div class="form-group">
                <label>{{ form.editors.label }}</label>
                {% if form.editors.field.queryset %}
                    <div class="checkbox-list">
                        {% for checkbox in form.editors %}
                            <div class="checkbox-item">
                                {{ checkbox.tag }}
                                {{ checkbox.choice_label }}
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="no-members">No other members to assign as editors</div>
                {% endif %}
                {% if form.editors.errors %}
                    <div class="error-message">{{ form.editors.errors }}</div>
                {% endif %}
            </div>
            
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">Update Permissions</button>
                <a href="{% url 'group_detail' group.id %}" class="btn btn-outline">Cancel</a>
            </div>
        </form>
    </div>
</div>
{% endblock %}
